
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>snakeoil.demandload &mdash; snakeoil v-trunk documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '-trunk',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="snakeoil v-trunk documentation" href="../index.html" />
    <link rel="up" title="API Documentation" href="../api.html" />
    <link rel="next" title="snakeoil.dependant_methods" href="snakeoil.dependant_methods.html" />
    <link rel="prev" title="snakeoil.data_source" href="snakeoil.data_source.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="snakeoil.dependant_methods.html" title="snakeoil.dependant_methods"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="snakeoil.data_source.html" title="snakeoil.data_source"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">snakeoil v-trunk documentation</a> &raquo;</li>
          <li><a href="../api.html" accesskey="U">API Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-snakeoil.demandload">
<span id="snakeoil-demandload"></span><h1>snakeoil.demandload<a class="headerlink" href="#module-snakeoil.demandload" title="Permalink to this headline">¶</a></h1>
<p>Demand load things when used.</p>
<p>This uses <tt class="xref py py-func docutils literal"><span class="pre">Placeholder()</span></tt> objects which create an actual object on
first use and know how to replace themselves with that object, so
there is no performance penalty after first use.</p>
<p>This trick is <em>mostly</em> transparent, but there are a few things you
have to be careful with:</p>
<blockquote>
<div><ul class="simple">
<li>You may not bind a second name to a placeholder object. Specifically,
if you demandload C{bar} in module C{foo}, you may not
C{from foo import bar} in a third module. The placeholder object
does not &#8220;know&#8221; it gets imported, so this does not trigger the
demandload: C{bar} in the third module is the placeholder object.
When that placeholder gets used it replaces itself with the actual
module in C{foo} but not in the third module.
Because this is normally unwanted (it introduces a small
performance hit) the placeholder object will raise an exception if
it detects this. But if the demandload gets triggered before the
third module is imported you do not get that exception, so you
have to be careful not to import or otherwise pass around the
placeholder object without triggering it.</li>
<li>Not all operations on the placeholder object trigger demandload.
The most common problem is that C{except ExceptionClass} does not
work if C{ExceptionClass} is a placeholder.
C{except module.ExceptionClass} with C{module} a placeholder does
work. You can normally avoid this by always demandloading the
module, not something in it.</li>
</ul>
</div></blockquote>
<p class="rubric">Functions</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr><td><a class="reference internal" href="#snakeoil.demandload.demand_compile_regexp" title="snakeoil.demandload.demand_compile_regexp"><tt class="xref py py-obj docutils literal"><span class="pre">demand_compile_regexp</span></tt></a>(scope,&nbsp;name,&nbsp;*args,&nbsp;...)</td>
<td>Demandloaded version of <a class="reference external" href="http://docs.python.org/library/re.html#re.compile" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">re.compile()</span></tt></a>.</td>
</tr>
<tr><td><a class="reference internal" href="#snakeoil.demandload.demandload" title="snakeoil.demandload.demandload"><tt class="xref py py-obj docutils literal"><span class="pre">demandload</span></tt></a>(scope,&nbsp;*imports)</td>
<td>Import modules into scope when each is first used.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="snakeoil.demandload.demandload">
<tt class="descclassname">snakeoil.demandload.</tt><tt class="descname">demandload</tt><big>(</big><em>scope</em>, <em>*imports</em><big>)</big><a class="reference internal" href="../_modules/snakeoil/demandload.html#demandload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snakeoil.demandload.demandload" title="Permalink to this definition">¶</a></dt>
<dd><p>Import modules into scope when each is first used.</p>
<p>scope should be the value of C{globals()} in the module calling
this function. (using C{locals()} may work but is not recommended
since mutating that is not safe).</p>
<p>Other args are strings listing module names.
names are handled like this:</p>
<div class="highlight-python"><pre>foo            import foo
foo@bar        import foo as bar
foo:bar        from foo import bar
foo:bar,quux   from foo import bar, quux
foo.bar:quux   from foo.bar import quux
foo:baz@quux   from foo import baz as quux</pre>
</div>
</dd></dl>

<dl class="function">
<dt id="snakeoil.demandload.demand_compile_regexp">
<tt class="descclassname">snakeoil.demandload.</tt><tt class="descname">demand_compile_regexp</tt><big>(</big><em>scope</em>, <em>name</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/snakeoil/demandload.html#demand_compile_regexp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snakeoil.demandload.demand_compile_regexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Demandloaded version of <a class="reference external" href="http://docs.python.org/library/re.html#re.compile" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">re.compile()</span></tt></a>.</p>
<p>Extra arguments are passed unchanged to <a class="reference external" href="http://docs.python.org/library/re.html#re.compile" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">re.compile()</span></tt></a>.</p>
<p>This returns the placeholder, which you <em>must</em> bind to C{name} in
the scope you pass as C{scope}. It is done this way to prevent
confusing code analysis tools like pylint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scope</strong> &#8211; the scope, just like for <a class="reference internal" href="#snakeoil.demandload.demandload" title="snakeoil.demandload.demandload"><tt class="xref py py-func docutils literal"><span class="pre">demandload()</span></tt></a>.</li>
<li><strong>name</strong> &#8211; the name of the compiled re object in that scope.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>&#64;returns: for compatibility, the placeholder object.  It&#8217;s deprecated to</dt>
<dd>rely on this however.</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="snakeoil.data_source.html"
                        title="previous chapter">snakeoil.data_source</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="snakeoil.dependant_methods.html"
                        title="next chapter">snakeoil.dependant_methods</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="snakeoil.dependant_methods.html" title="snakeoil.dependant_methods"
             >next</a> |</li>
        <li class="right" >
          <a href="snakeoil.data_source.html" title="snakeoil.data_source"
             >previous</a> |</li>
        <li><a href="../index.html">snakeoil v-trunk documentation</a> &raquo;</li>
          <li><a href="../api.html" >API Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Brian Harring.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>